Programmable interactions and emergent geometry in an array of atom clouds | Nature
2021
https://doi.org/10.1038%2Fs41586-021-04156-0

Thank you for visiting nature.com. You are using a browser version with limited support for CSS. To obtain the best experience, we recommend you use a more up to date browser (or turn off compatibility mode in Internet Explorer). In the meantime, to ensure continued support, we are displaying the site without styles and JavaScript.
Advertisement View all journals Search Log in Explore content About the journal Publish with us Sign up for alerts RSS feed nature articles article Download PDF Article Published: 22 December 2021 Programmable interactions and emergent geometry in an array of atom clouds Avikar Periwal ORCID: orcid.org/0000-0001-7601-0932 1 na1 , Eric S. Cooper 1 na1 , Philipp Kunkel ORCID: orcid.org/0000-0002-8145-9184 1 , 2 na1 , Julian F. Wienand ORCID: orcid.org/0000-0001-9347-0850 1 , 3 , Emily J. Davis 1 & … Monika Schleier-Smith ORCID: orcid.org/0000-0002-4686-3528 1 , 2 Show authors Nature volume 600 , pages 630–635 ( 2021 ) Cite this article 9345 Accesses 65 Citations 96 Altmetric Metrics details Subjects Quantum optics Quantum simulation Ultracold gases An Author Correction to this article was published on 11 March 2022 This article has been updated Abstract Interactions govern the flow of information and the formation of correlations between constituents of many-body quantum systems, dictating phases of matter found in nature and forms of entanglement generated in the laboratory. Typical interactions decay with distance and thus produce a network of connectivity governed by geometry—such as the crystalline structure of a material or the trapping sites of atoms in a quantum simulator 1 , 2.
 However, many envisioned applications in quantum simulation and computation require more complex coupling graphs including non-local interactions, which feature in models of information scrambling in black holes 3 , 4 , 5 , 6 and mappings of hard optimization problems onto frustrated classical magnets 7 , 8 , 9 , 10 , 11.
 Here we describe the realization of programmable non-local interactions in an array of atomic ensembles within an optical cavity, in which photons carry information between atomic spins 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19.
 By programming the distance dependence of the interactions, we access effective geometries for which the dimensionality, topology and metric are entirely distinct from the physical geometry of the array. As examples, we engineer an antiferromagnetic triangular ladder, a Möbius strip with sign-changing interactions and a treelike geometry inspired by concepts of quantum gravity 5 , 20 , 21 , 22.
 The tree graph constitutes a toy model of holographic duality 21 , 22 , in which the quantum system lies on the boundary of a higher-dimensional geometry that emerges from measured correlations 23.
 Our work provides broader prospects for simulating frustrated magnets and topological phases 24 , investigating quantum optimization paradigms 10 , 11 , 25 , 26 and engineering entangled resource states for sensing and computation 27 , 28.
You have full access to this article via your institution.
Download PDF Download PDF Main Controllable quantum systems of cold atoms constitute powerful platforms for applications ranging from quantum simulation 2 to entanglement-enhanced measurement 12 , 14 , 15 , 29.
 Positioning atoms in optical tweezers and inducing local interactions by excitation to Rydberg states enables simulations of lattice spin models 2 and bottom-up control of entanglement 30.
 In a complementary top-down paradigm, collective entangled states have been generated in ensembles of up to 5 × 10 5 atoms with all-to-all interactions mediated by photons in optical cavities 12 , 13 , 14 , 15 or by collisions in Bose–Einstein condensates 29 , 30 , 31 , 32 , 33 , 34.
 For photon-mediated interactions, or analogous phonon-mediated interactions among trapped ions 35 , 36 , using multiple bosonic modes further enables tuning of the interaction range 35 , 36 , 37.
Yet many objectives demand more versatile control of the graph of interactions 5 , 6 , 8 , 9 , 24 , 38 , including couplings that are neither local nor global. Engineering a wider range of non-local graphs opens up prospects for accessing spin-glass phases 8 , 9 and new topologically ordered states 24 , exploring analogue approaches to combinatorial optimization 10 , 11 , 25 , 26 and probing toy models of quantum gravity 5 , 6 , 39.
 These goals have motivated proposals for programming the distance dependence of spin-exchange interactions in arrays of atoms or ions by tailoring the frequency spectrum of a drive field 5 , 24 , 38 , which couples the spins to a single mode of light or motion.
We realize programmable spin-exchange interactions in an array of atomic ensembles within an optical cavity. Our scheme (Fig.
1 ) produces a class of spin models described by an effective Hamiltonian $${H}_{{\rm{e}}{\rm{f}}{\rm{f}}}=-\sum _{\mu ,\nu }J({r}_{\mu \nu }){f}_{\mu }^{\,+}{f}_{\nu }^{-}+{H}_{{\rm{q}}}.$$ a , An array of atomic ensembles initialized in the m = 0 Zeeman state is trapped inside an optical cavity. We apply a magnetic field gradient Δ B , which leads to a difference Δ E = ħrω B in the Zeeman splittings of atoms separated by a distance r.
 By modulating the intensity of the drive field at a frequency rω B , we generate correlated atom pairs in states m = ±1 at distance r.
b , Measured correlations C pm for three different combinations of magnetic field gradient, shown by the dependence of Δ E on distance (red circles) and drive field spectrum (blue lines).
Full size image Here﻿ f μ + and f ν − denote the raising and lowering operators for the Zeeman spin of atoms μ and v, respectively; the distance between atoms is r μν and H q represents the quadratic Zeeman energy. The spin-exchange coupling J arises from a process in which one atom flips its spin down while scattering a photon from a drive field into the cavity and a second atom rescatters this photon to flip its spin up 17 , 18.
 We focus on a system of spin-1 atoms initialized in the m = 0 Zeeman state, in which the effect of this ‘flip-flop’ interaction is to produce correlated atom pairs in states m = ±1 (refs.
17 , 27 , 31 , 33 , 34 , 40 ).
Whereas the single-mode cavity ordinarily mediates interactions among all sites, we break this all-to-all connectivity by introducing a magnetic field gradient along the cavity axis. The gradient introduces an energy difference ħω B between the Zeeman splittings on adjacent sites, such that spin-exchange processes are off-resonant for spatially separated spins. To controllably reintroduce interactions between ensembles spaced by a distance of r sites, we modulate the intensity of the drive field at frequency rω B , thus modulating the instantaneous spin-exchange coupling \(\tilde{J}(t)\) as a function of time t.
 More generally, to obtain a specified set of couplings J ( r ) = J *﻿ (− r ) in equation ( 1 ), we set a drive waveform $$\tilde{J}(t)=\sum _{r}{{\rm{e}}}^{-{\rm{i}}r{\omega }_{B}t}J(r)$$ according to the Fourier transform of the couplings. The drive waveform thus determines the dispersion relation \({\chi }_{k}=-2N\tilde{J}(k/{\omega }_{B})\) for spin waves with momentum k , in dimensionless units of inverse sites, in a system of N atoms per site.
We benchmark the interactions in a one-dimensional array of M = 18 ensembles of N ≈ 10 4 rubidium-87 atoms, initializing all atoms in state m = 0. This initial state with no average magnetization would classically have trivial dynamics. However, quantum fluctuations are amplified by the cavity-mediated interactions, producing correlated growth and macroscopic fluctuations in the populations of states m = ±1 (ref.
17 ). The spatial correlations of these amplified fluctuations reveal the connectivity of interactions.
To implement distance-dependent interactions, we optically drive the cavity for 100 to 200 μs, thereby transferring 30–50% of the atoms into the states m = ±1. Subsequently, we perform state-sensitive imaging to obtain the correlations $${C}_{ij}^{{\rm{pm}}}=\frac{{\rm{Cov}}({N}_{+,i},{N}_{-,j})}{\sqrt{{\rm{Var}}({N}_{+,i}){\rm{Var}}({N}_{-,j})}}\equiv {\rm{Corr}}({N}_{+,i},{N}_{-,j}),$$ for each pair of sites ( i , j ), in the populations N +, i , N −, j of states m = ±1. Here, Cov and Var denote the covariance and the variance, respectively. Figure 1b shows the measured correlations for three different scenarios. For a monochromatic drive field, in a uniform magnetic field, we observe correlations of equal strength between all sites, indicating the expected all-to-all interactions. By contrast, adding a magnetic field gradient results in correlations being localized to individual sites. Finally, modulating the intensity of the drive light at frequency rω B produces correlations between all pairs of sites separated by a distance | i − j | = r , as shown for r = 10.
The dependence of spatial correlations on modulation fre-quency is shown in Fig.
2a.
 There, we plot the average correlation \({C}^{{\rm{pm}}}(d)=\sum _{i}{C}_{i,i+d}^{{\rm{pm}}}/(M-|d|)\) of sites separated by distance d.
 Plotting C pm ( d ) as a function of modulation frequency rω B , for integer values r , reveals correlations at distances d = ± r and d = 0. While the correlations at d = 0 indicate on-site pair creation that is resonant even for a single drive frequency, the correlations at d = ± r confirm the presence of interactions at the distance set by the modulation frequency. The interactions are spectrally well resolved as a function of drive frequency (Fig.
2a , inset), highlighting the precise control of the coupling distance.
a , Correlations C pm versus modulation frequency ω and distance. Setting ω = rω B generates correlations C pm at a distance r.
 Inset, correlations C pm appearing only when satisfying a resonance condition ω = rω B for integer r.
b , Measurements of c xx for sinusoidal modulation at frequency 3 ω B reveal spreading of correlations to integer multiples of the distance r = 3 after time T Bloch periods.
c , Magnitude of the structure factor \(|{\tilde{F}}_{k}^{x}|={\langle {\tilde{F}}_{k}^{x}{\tilde{F}}_{-k}^{x}\rangle }^{1/2}\) after 1, 2 and 3 Bloch periods, illustrating the relationship between the drive waveform \(\tilde{J}(t)\) and the momentum-space dynamics. Error bars show s.e.m. and curves show model \(|{\tilde{F}}_{k}^{x}|\propto |\tilde{J}(k/\omega ){|}^{T}\) , with amplitude as the only free parameter.
d , Pulsing the drive waveform at frequency Mω B generates periodic boundary conditions, evidenced by correlations at distances r and M − r.
Full size image To sensitively probe the growth and spreading of correlations, we examine the transverse magnetization, which provides an enhanced signal at early times. Specifically, we evaluate the normalized covariance \({c}^{xx}={\rm{Cov}}({{F}_{i}}^{x},{F}_{i+d}^{x})/{N}^{2}\) , where \({{\bf{F}}}_{i}=\sum _{\mu \in i}{{\bf{f}}}_{\mu }\) denotes the collective magnetization on site i in a rotating frame set by the local magnetic field. Figure 2b shows c xx as a function of time and distance d , averaged over all sites i , for a system programmed to interact at distance r = 3. Correlations first appear between nearest neighbours on the coupling graph and spread over time to further neighbours at multiples of the distance r.
 We additionally compute the structure factor \({\tilde{F}}_{k}^{x}=\sum _{l}{{\rm{e}}}^{{\rm{i}}kl}{F}_{l}^{x}/\sqrt{M}\) , plotting its root mean square value in Fig.
2c.
 We observe narrowing in momentum space as a function of time, complementary to the observed spreading of correlations in position space.
The growth of the structure factor is consistent with an analytical model in which spin waves of momentum k are amplified by a factor proportional to | χ k | per Bloch period of evolution. Equivalently, the growth in \(|{\tilde{F}}_{k}^{x}|\) for each momentum mode k is proportional to the drive intensity \(\tilde{J}(t)\) at time t = k / ω B.
 The amplification is notably strongest at minima of the dispersion relation χ k < 0. Pair creation thus drives the system towards states of minimal interaction energy, while increasing the quadratic Zeeman energy H q to compensate.
Engineering the dispersion relation via the drive waveform enables the realization of periodic boundary conditions, despite the physical geometry of our array as an open chain. For a chain of M sites with periodic boundary conditions, the domain of the dispersion relation is a discrete set of points in momentum space, spaced by Δ k = 2π/ M.
 Correspondingly, we break the drive waveform into a train of short pulses with spacing τ B / M in time, where τ B = 2π/ ω B is the Bloch oscillation period for spin excitations. For an initial sinusoidal modulation designed to introduce interactions at distance r , the pulsed variant has a frequency spectrum that includes peaks at both rω B and ( M − r ) ω B.
 The resulting correlations C pm , shown in Fig.
2d , are strongest at distances d = ± r and d = ±( M − r ), indicating that the system now behaves as though the sites were situated on a ring.
We verify the periodic boundary conditions by directly reconstructing the effective geometry of the system from measured spin correlations \({C}_{ij}^{xx}={\rm{Corr}}({F}_{i}^{x},{F}_{j}^{x})\).
 Adopting an ansatz that correlations decay as a Gaussian function \(|{C}_{ij}^{xx}|\propto \exp (-|{{\boldsymbol{\rho }}}_{i}-{{\boldsymbol{\rho }}}_{j}{|}^{2})\) of distance |﻿ ρ i − ρ j | in a D -dimensional space, we seek a mapping of the array sites to effective coordinates ρ i that best fit the distances \({d}_{ij}=\sqrt{-\,\log \,|{C}_{ij}^{xx}|}\) inferred from the correlations ( Methods ). We obtain the coordinates ρ i from the distance matrix d ij by metric multidimensional scaling. The result is shown in Fig.
3a for a system with nearest-neighbour interactions and periodic boundary conditions. We additionally calculate an inferred coupling matrix J ′ = ( C xx ) −1.
 Colouring the edges between all pairs of sites according to J ′ corroborates the ring-like coupling graph.
a – e , Ring ( a ), disconnected chains ( b ), triangular antiferromagnetic ladder ( c ), cylinder with anisotropic sign of interactions ( d ) and Möbius ladder with oppositely signed interactions along the edge and width ( e ). Top row, connectivity graphs, with red (blue) bonds indicating ferromagnetic (antiferromagnetic) couplings between sites labelled by position in array. Second row, structure factor (purple circles) measured after T = 2 Bloch periods is proportional to squared dispersion relation χ k 2 (blue shaded region). Third row, correlations C xx.
 Bottom row, reconstructed geometries in D = 3 dimensions, with Cartesian coordinates ρ.
 Colour and opacity of bonds indicate sign and magnitude of the inferred coupling J ′, respectively.
Full size image Tailoring the drive waveform enables versatile control over the geometry and topology of the coupling graph, as we illustrate by the same black-box reconstruction technique. We first observe that introducing interactions at a distance r > 1, with open boundary conditions, produces a set of r disjoint chains, as depicted in Fig.
3b for r = 3. Linking such chains with a second modulation frequency generates a two-dimensional graph, as shown by the triangular ladder in Fig.
3c , formed by interactions at distances r 1 = 1 and r 2 = 2. Furthermore, adding periodic boundary conditions enables the realization of non-trivial topologies. For example, Fig.
3d shows a square-lattice cylinder, whereas Fig.
3e shows a Möbius ladder. The characteristic twist of the Möbius strip is evident in the crossing of two bonds in the reconstructed geometry.
For a given coupling graph, the sign of the interaction J ( r ) at each distance r is set by the phase of the modulation at frequency rω B.
 We always choose the on-site interaction to be ferromagnetic, favouring a large spin polarization on each site, and choose a phase \(\text{arg}[J(r)]\in \{0,\pi \}\) to set either ferromagnetic or antiferromagnetic couplings at each non-zero distance r.
 Figure 3 includes examples with ferromagnetic (Fig. 3a, b), anti-ferromagnetic (Fig. 3c) and sign-changing (Fig. 3d, e) couplings.
The antiferromagnetic triangular ladder in Fig.
3c constitutes a fully frustrated XY model 41.
 In the classical ground state, adjacent spins have a relative angle of approximately 120° (white arrows in Fig.
3c (top row) ). The measured spin correlations in Fig.
3c are consistent with the predicted ordering, with two degenerate minima in the spin-wave dispersion χ k producing peaks in the structure factor at k = ±0.58π (Fig.
3c (second row) ), corresponding to the two possible directions of phase winding. The correct reconstruction of the ladder edges J ′ ≈ J in Fig.
3c (bottom row) further highlights that the pair creation dynamics generate an approximate low-temperature state of the XY model ( Methods ).
Our approach also enables the specification of interactions that change sign as a function of distance, as we illustrate for the cylinder and the Möbius ladder in Fig.
3d, e.
 In each case, by choosing opposite signs of interaction for two distances r 1 and r 2 between sites in the atom array, we obtain an anisotropic sign of the interaction on the two-dimensional manifold representing the effective geometry (Fig.
3d, e (bottom row) ). For example, in the Möbius strip, the ferromagnetic interactions at distance r 1 = 1 give rise to ferromagnetic correlations (red bonds) all along the singular edge of the strip, whereas the antiferromagnetic couplings at distance r 2 = 9 are manifest in the antiferromagnetic correlations (blue bonds) across the width of the strip (Fig.
3e (bottom row) ). The measured correlations are indicative of the transverse magnetization winding by 2π along the closed loop formed by the edge of the strip.
Engineering non-local couplings enables radically different geometries to be explored, beyond those that can be visualized by an embedding of sites in a Euclidean space. Inspired by models of quantum gravity 21 , 22 , we proceed to simulate a non-Archimedean geometry 5 , 42 , for which the points on the real line are best viewed as leaves on an infinite regular tree graph. Such tree graphs feature in a version of the anti-de Sitter/conformal field theory correspondence ( p -adic AdS/CFT) 21 , 22 , in models of information scrambling in black holes 20 and in tensor-network representations of strongly correlated states 43 , 44.
To access a treelike geometry, we engineer couplings $$J(i-j)\propto \{\begin{array}{ll}|i-j{|}^{s} & |i-j|={2}^{n},\,n\in {\mathbb{Z}}\\ 0 & {\rm{otherwise}},\end{array}$$ depicted in Extended Data Fig. 1, where the parameter s enables tuning between Archimedean and non-Archimedean regimes 5.
 For s < 0 the system is approximately a one-dimensional chain (Fig.
4a (top) ), whereas setting s > 0 theoretically produces the treelike geometry shown in Fig.
4a (bottom) (refs.
5 , 42 ). Each leaf represents an array site, the position of which in the tree is determined by branching left or right at level a if the a th bit of the site index i is 0 or 1. Starting from the base of the tree, the first branching is governed by the least significant bit. Thus, the order of sites in the tree is rearranged from the physical order by the Monna map \( {\mathcal M} (i)\) , which reverses the order of bits in the site index i.
a , Waveforms \(\tilde{J}(t)\) generating Archimedean (top) and treelike (bottom) interactions. The two geometries are related via the Monna map \( {\mathcal M} \) (green arrows).
b , c , Archimedean ( b ) and treelike ( c ) orderings of C xx.
 Correlations decay smoothly only as a function of Archimedean distance | i − j | for s = −1, and only as a function of treelike distance | i − j | 2 for s = 1.
d , Black-box bulk reconstructions from C xx reveal no bulk for s = −1 and a binary tree structure for s = 1.
e , Coarse-grained bipartite correlation C b versus exponent s for partitions according to Archimedean (blue circles) and treelike (green squares) ordering of sites. The minimal correlation over all possible bipartitions (purple triangles) is peaked at s = 0, signifying a breakdown of locality. Error bars denote s.d. estimated by jackknife resampling.
Full size image We confirm the transition from an Archimedean to a treelike geometry by measuring correlations C xx for s = ±1. We implement both models for M = 16 sites with periodic boundary conditions, using the drive waveforms in Fig.
4a (top), (bottom).
 For each value of s , we show C xx as a function of physical positions i , j (Fig.
4b ) and as a function of positions \( {\mathcal M} (i), {\mathcal M} (j)\) on the tree (Fig.
4c ). Whereas for s = −1 the correlations decay smoothly as a function of physical distance, for s = 1 we observe a non-monotonic dependence on physical distance due to the highly non-local structure of interactions. The Monna-mapped correlations for s = 1, however, are strongest near the diagonal—indicating a new sense of locality in the non-Archimedean geometry—and exhibit blocks consistent with the hierarchical structure of the tree.
To corroborate the realization of a non-Archimedean geometry, we plot the dependence of correlations on a treelike measure of distance in Fig.
4c.
 The natural metric for the treelike geometry is the 2-adic norm | i − j | 2 = 2 – a , where a is the largest integer such that 2 a divides | i − j |. Intuitively, a represents the level of the tree—counting up from the base—at which the leaves representing sites i and j connect. As a function of 2-adic distance, we observe a smooth decay of correlations.
A key feature of the tree graph is that only the vertices on the boundary represent physical sites, whereas the interior vertices constitute a holographic bulk geometry embodying the effective distance between sites. To investigate the validity of this holographic description, we perform a black-box reconstruction of the bulk geometry from spin correlations. We begin by mapping the physical sites to effective coordinates in a Euclidean space, as before. Next, we draw bonds between pairs of maximally correlated sites and perform a coarse-graining procedure, treating each group of connected sites as a new larger site, and drawing new connections, until there is a path through the bulk between any two sites on the boundary.
The bulk reconstructions are shown in Fig.
4d for both the Archimedean ( s = −1) and non-Archimedean ( s = 1) cases. For s = −1, where interactions between physical neighbours dominate, the reconstruction produces only a one-dimensional loop. By contrast, for s = 1, a tree emerges from the reconstruction as a bulk geometry encapsulating the structure of spin correlations. This emergent geometry is analogous to the gravitational bulk in the p -adic AdS/CFT correspondence, in which the tree serves as a discretized version of hyperbolic space 21 , 22.
The transition between two radically different geometries depending on the sign of the exponent s suggests that all sense of locality is lost as s approaches zero. To probe the breakdown of locality, we consider different possible bipartitions of the M = 16 sites into 8-site subsystems I and J and examine correlations between the subsystems (Fig.
4e ). Specifically, we plot a bipartite correlation C b = Corr( F I x , F J x ), where \({F}_{I}^{x}=\sum _{i\in I}{F}_{i}^{x}\) denotes a coarse-grained spin, as a function of s.
 For s < 0, the correlation C b is smaller for a cut that is local according to the physical ordering of sites (blue circles) than for a cut that is local on the tree (green squares), whereas for s > 0 the situation is reversed, consistent with the change in effective geometry. Further plotting the minimum correlation C b over all possible bipartitions (purple triangles) reveals a peak at s = 0, indicating the absence of any geometry providing a sense of locality.
The breakdown of locality at s = 0 paves the way for studies of fast scrambling 5 , the generation of system-wide entanglement at a conjectured maximal rate characteristic of black holes 3.
 More broadly, our work provides a starting point for quantum simulations to investigate the conjecture that space–time geometry and gravity emerge from entanglement 23.
 The treelike geometry can serve as a model for probing transport through the holographic bulk and enable implementations of holographic error-correcting codes 22 , 45.
 Furthermore, our reconstruction of the bulk offers a blueprint for seeking gravitational duals in a wide range of quantum many-body systems.
Future experiments will probe entanglement generated by programmable pair creation, which theoretically produces multimode spin-nematic squeezed states 27 , 31 , analogous to continuous-variable cluster states 28.
 Applying these states to image spatially extended fields with quantum-enhanced sensitivity will allow the quantification of entanglement depth 40 and the characterization of the structure of multipartite entanglement 28.
 In our current system, the large collective cooperativity Nη = 3 × 10 4 per subensemble, which parameterizes the coherence of atom–light interactions, theoretically permits metrological gains scaling as \(\sqrt{N\eta }\) (see Supplementary Information). Quantifying metrological gain to demonstrate entanglement will require an accurate calibration of the quantum projection noise level, high-fidelity state detection and measurements in additional bases.
The antiferromagnetic and sign-changing interactions demonstrated here open up new opportunities for studies of frustrated magnetism. Introducing disorder will allow the realization of spin-glass models 8 , 9 that map to NP hard problems in pattern recognition 25 , 46 and optimization 11.
 Our observation that pair creation generates low-temperature states of the classical XY model suggests applications to gain-based optimization, building on past experiments with networks of polariton condensates 11 or optical parametric oscillators 10.
 Our scheme also generalizes to implementing synthetic gauge fields by introducing complex-valued couplings 24 , 47 , 48 , for explorations of topological physics. Extensions to an array with a single spin per site may allow strongly correlated states to be acessed. This regime could be explored with individually trapped atoms in a cavity or waveguide with state-of-the-art single-atom cooperativity η ~ 100, and in extensions of our method to Rydberg superatoms 49 , colour centres 50 or trapped ions 38.
Methods Experimental sequence We begin by loading rubidium-87 atoms from a magneto-optical trap into an array of microtraps, in which we use optical pumping and adiabatic microwave sweeps to prepare the atoms in the | F = 1, m = 0 ⟩ state. We then transfer the atoms into a 1,560 nm optical lattice supported by the cavity, resulting in a set of M = 16 or 18 discrete ensembles. To generate programmable interactions between the ensembles, we apply a magnetic field gradient and drive the optical cavity along its axis with a modulated intensity. After the interaction time, we load the atoms back into the microtraps and use state-selective fluorescence imaging to measure the population in each Zeeman state. To measure the transverse magnetization, we apply a series of local spin rotations before the imaging sequence. Extended Data Figure 2a shows a schematic of the experimental sequence.
Microtraps and lattice transfer Our experiments use a hybrid trapping scheme: whereas we perform cooling, internal state preparation and imaging in a microtrap array, we transfer the atoms to an intracavity optical lattice before inducing cavity-mediated interactions. The 1,560 nm intracavity lattice is in registry with the standing wave of 780 nm light used to drive interactions and thus maximizes the atom–light coupling. However, because the 1,560 nm light produces a strong and inhomogeneous a.c. Stark shift of the 5 P 3/2 state 51 , we instead use the 808 nm microtrap array during the parts of the experimental sequence requiring near-resonant light, namely cooling, optical pumping and fluorescence imaging.
We initially turn on a two-dimensional array of M × 2 optical microtraps at 808 nm during magneto-optical trap loading. The long axis of the array is aligned with the cavity axis, with 60 μm between traps. The two transverse traps are designed to double the total trap volume and, correspondingly, the number of atoms loaded into the cavity for a fixed microtrap waist. Each microtrap has a waist of 6 μm and a depth of h × 4 MHz, where h is Planck’s constant. During the loading phase the transverse microtrap spacing is 100 μm. After loading the microtraps, the transverse spacing is reduced to 8 μm, so that both transverse traps fit within the 25 μm waist of the intracavity lattice. We adiabatically transfer the atoms from the microtraps to the intracavity lattice, increasing the lattice power from an initial depth of h × 200 kHz to h × 3.5 MHz and then ramping off the microtraps. This preparation results in a one-dimensional array of M ensembles at a temperature of 100 μK, with each ensemble containing N ≈ 10 4 atoms spread over 10 lattice sites.
For imaging, we transfer the atoms from the optical lattice back into the microtrap array by first switching on the M × 2 microtraps before reducing the lattice depth to h × 200 kHz. Subsequently, we adiabatically move the microtraps away from the optical lattice by approximately 15 μm to avoid a.c. Stark shifts during imaging. The efficiency of this transfer from the lattice to microtraps is 80–90%. Additionally, the 808 nm trapping light causes 20% of the atoms to undergo state-changing scattering events before the end of the imaging sequence.
Imaging and spin readout We detect the atoms in a sequence of four fluorescence images designed to independently measure the populations of all three Zeeman states within the F = 1 manifold and any residual atoms in F = 2. For each fluorescence image we apply a retro-reflected laser beam resonant with the microsecond transition of the D2 line for 100 μs and collect the resulting fluorescence signal on an electron multiplying charge-coupled device (EMCCD) camera. With the first imaging pulse, we measure the population in the F = 2 manifold, expelling these atoms from the microtraps by heating. For state-selective imaging of the F = 1 manifold, we sequentially apply three microwave sweeps that adiabatically transfer the atoms from each magnetic substate to F = 2 and perform fluorescence imaging after each sweep. A typical fluorescence signal of the atoms is shown in Extended Data Fig.
2b.
 For background subtraction we use a method from Xu et al.
52 based on a principal component analysis of approximately 100 images without atoms. Technical noise in the measurement is approximately 1–2% of the total atom number.
To measure the transverse spin component \({F}_{i}^{x}\) we sequentially perform local spin rotations at each site i before the imaging sequence. For this purpose, we focus a circularly polarized laser onto each site by controlling the position of the beam with an acousto-optic deflector. By modulating the intensity of the laser at the local Larmor frequency, we induce a resonant Raman coupling between adjacent magnetic sublevels. We apply a 3 μs Raman pulse to produce a π/2 spin rotation. This locally maps \({F}_{i}^{x}\) onto the measurable population difference \({N}_{+,i}-{N}_{-,i}\) , illustrated in Extended Data Fig.
2c.
 Here, \({F}_{i}^{x}\) is defined in a rotating frame that depends on the local Larmor frequency at site i.
 Shot-to-shot fluctuations in the Larmor frequency lead to a reduction in the measurable correlations between two sites, for which the reduction depends on the time between the corresponding Raman pulses. Thus, to suppress any bias in the measured correlations, we randomize the order of the local spin rotations in each experimental realization.
Computation of correlations When visualizing the distance dependence of interactions, reconstructing effective geometries or probing bipartite correlations, we compute correlation functions C pm , C xx and C b from a minimum of 50 measurements (see Extended Data Fig.
3 and the Supplementary Information for the effects of finite statistics). Each correlation function is defined in the main text in terms of specified observables A and B as $${\rm{Corr}}(A,B)=\frac{{\rm{Cov}}(A,B)}{\sqrt{{\rm{Var}}(A){\rm{Var}}(B)}},$$ where \({\rm{Cov}}(A,B)\equiv \langle AB\rangle -\langle A\rangle \langle B\rangle \) and \({\rm{Var}}(A)\equiv {\rm{Cov}}(A,A)\).
 These correlations are normalized to the shot-to-shot variance, which provides the relevant spatial information while being agnostic to the total amount of pair creation. Effects of finite statistics on the measured correlations C pm are examined in Extended Data Fig.
3.
To quantify pair creation dynamics, we measure in the \(\hat{x}\) -basis and normalize the covariance matrices to the population of atoms on each site rather than their variance, $${c}_{ij}^{xx}=\frac{{\rm{Cov}}({F}_{l}^{x},{F}_{m}^{x})}{{N}^{2}}\approx \frac{\langle {F}_{l}^{x}{F}_{m}^{x}\rangle }{{N}^{2}}.$$ For this correlator, the measurement in the \(\hat{x}\) -basis provides a high sensitivity at early times and a large dynamic range for measurements over time. The normalization is chosen such that the extracted correlation is sensitive to the total amount of pair creation, allowing us to visualize the growth of correlations as a function of time.
Interaction parameters To enable the programmable interactions, we apply a magnetic field gradient parameterized by the difference \({\omega }_{B}\) in Zeeman splittings between adjacent array sites. This gradient is superposed on an overall bias field B 0 perpendicular to the cavity axis, which produces a Zeeman splitting of \({\omega }_{z}/{B}_{0}=2{\rm{\pi }}\times 700\,{\rm{kHz}}\,{{\rm{G}}}^{-1}\) and a quadratic Zeeman shift of \(q/{B}_{0}^{2}=2{\rm{\pi }}\times 72\,{\rm{Hz}}\,{{\rm{G}}}^{-2}\).
 We work in a regime in which \({\omega }_{z}/M > {\omega }_{B} > q\) , that is, the variation in the magnetic field is small compared with the average field yet results in a Bloch oscillation frequency larger than the quadratic Zeeman shift. Specifically, we choose a magnetic field between 2 G and 4 G (as detailed in Extended Data Table 1 for each dataset) and a typical gradient \({\omega }_{B}=2{\rm{\pi }}\times 1.52(1)\,{\rm{kHz}}\) per site, where parentheses denote one s.d. uncertainty on the last digit. For measurements of C pm in Figs.
1 and 2 , we increase the ratio ω B /q.
 This is accomplished either by increasing ω B to \(2{\rm{\pi }}\times 12.47(2)\,{\rm{kHz}}\) per site, or by reducing the effective quadratic Zeeman shift to \(q=2{\rm{\pi }}\times 70\,{\rm{Hz}}\) by applying an a.c. Stark shift to the \(|1,0\rangle \) state. To induce an a.c. Stark shift, we off-resonantly couple the states \(|1,0\rangle \) and \(|2,0\rangle \) via blue-detuned microwave radiation. The resulting energy shift is given by \({q}_{{\rm{mw}}}={\varOmega }_{{\rm{mw}}}^{2}/4{\delta }_{{\rm{mw}}}\) , where \({\varOmega }_{{\rm{mw}}}=2{\rm{\pi }}\times 10\,{\rm{kHz}}\) is the resonant Rabi frequency and \({\delta }_{{\rm{mw}}}=2{\rm{\pi }}\times 115\,{\rm{kHz}}\) is the detuning.
We induce spin-exchange interactions among the atoms by applying a drive field detuned from cavity resonance. After accounting for a resonance shift due to the presence of atoms, we choose a typical drive-cavity detuning between \({\delta }_{{\rm{c}}}=-2{\rm{\pi }}\times 4\,{\rm{MHz}}\) and \({\delta }_{{\rm{c}}}=-2{\rm{\pi }}\times 7\,{\rm{MHz}}\).
 The cavity mode itself has a large detuning of \(\varDelta =-2{\rm{\pi }}\times 11\,{\rm{GHz}}\) from atomic resonance. The drive field is linearly polarized at an angle of 55 o with respect to the magnetic field, which is chosen to eliminate tensor light shifts. The instantaneous spin-exchange coupling is given by \(-\tilde{J}(t)\approx {n}_{{\rm{ph}}}(t){\varOmega }^{2}/(2{\delta }_{{\rm{c}}})\) , where \(\varOmega =2{\rm{\pi }}\times 13\,{\rm{Hz}}\) is the vector a.c. Stark shift per circularly polarized photon in the cavity and n ph ( t ) is the mean intracavity photon number due the control field driving the cavity. The average intracavity photon number over a full period of the drive waveform is typically \({\bar{n}}_{{\rm{ph}}}\approx 2\times {10}^{3}\).
 This results in an average collective interaction strength of \(2N\tilde{J}=2{\rm{\pi }}\times 0.6\,{\rm{kHz}}\) between ensembles of N = 10 4 atoms.
To produce a set of couplings J ( r ), we modulate the intensity of the drive field via an acousto-optic modulator as $$\tilde{J}(t)=2\sum _{r > 0}[\cos (r{\omega }_{B}t+{\varphi }_{r})+1]|J(r)|$$ where we use the phases \({\varphi }_{r}\in \{0,{\rm{\pi }}\}\) to set the sign of the interactions. The coupling at r = 0 is given by \(J(0)=2\sum _{r > 0}|J(r)|\).
 To produce periodic boundary conditions in the system of M sites, we additionally pulse the drive at a frequency of \(M{\omega }_{B}\).
 Each pulse has a duration of \(0.3{\tau }_{{\rm{B}}}/M=11\,{\rm{\mu }}{\rm{s}}\).
 To keep the average interaction strength constant, we increase the drive strength during these pulses so that the number of drive photons in the cavity reaches a peak of up to \({n}_{{\rm{ph}}}\approx {10}^{4}\).
We choose the total duration of the interactions to be at least one Bloch period such that dynamics are localized to single ensembles. In general, the Fourier limit for the resolution of the interactions (measured in sites) is given by the ratio 1/ T of the Bloch period to the total interaction time. After a single Bloch period, interactions are thus localized to less than the spacing between sites, as shown in the inset to Fig.
2a for an interaction duration of T = 2.5 Bloch periods. A beneficial effect of Fourier broadening is to delocalize the interactions to more than the spatial extent of each ensemble. As the extent of each ensemble is approximately one-eighth of the distance between ensembles, we limit the duration of the drive pulse to T < 8 Bloch periods for all experiments.
Localization of interactions to specified distances also requires precise calibration of the magnetic field gradient such that the uncertainty in the target drive frequency \(r{\omega }_{B}\) is less than the Fourier broadening of the drive field spectrum. In some measurements, the gradient can drift by up to 1.5%. This most strongly affects the resonance condition at longer distances, for example r > 15 in Fig.
2a.
 We model this effect in Supplementary Fig. 1.
Cavity parameters The atoms are coupled to a near-concentric Fabry–Perot cavity with a length of 5 cm and an 18 μm waist at 780 nm. The cavity has vacuum Rabi frequency of \(2g=2{\rm{\pi }}\times 2.6\,{\rm{MHz}}\) and linewidth \(\kappa =2{\rm{\pi }}\times 250(20)\,{\rm{kHz}}\) , yielding a single-atom cooperativity \(\eta =\frac{4{g}^{2}}{\kappa \Gamma }=4.5\) , where \(\Gamma =2\pi \times 6.07\,{\rm{M}}{\rm{H}}{\rm{z}}\) is the linewidth of the \(5{P}_{3/2}\) state in rubidium. Our drive field is detuned by \(\varDelta =-2{\rm{\pi }}\times 11\,{\rm{GHz}}\) from the \(|5{S}_{1/2},F=1\rangle \to |5{P}_{3/2}\rangle \) transition, which produces a vector light shift per circularly polarized photon of \({\varOmega }_{0}=-\frac{{g}^{2}}{6\varDelta }=2{\rm{\pi }}\times 26\,{\rm{Hz}}\) on a maximally coupled atom at cavity centre. For an average atom this dispersive coupling is reduced to \(\varOmega =2{\rm{\pi }}\times 13\,{\rm{Hz}}\) , primarily by thermal motion. This reduction is accounted for in our measurements of the collective cooperativity \(N\eta =3\times {10}^{4}\).
 The Rayleigh range of the cavity is \({z}_{{\rm{R}}}=1.3\,{\rm{mm}},\) and each ensemble is within \(0.4{z}_{{\rm{R}}}=520\,{\rm{\mu }}{\rm{m}}\) of the cavity centre. Displacement from the cavity centre contributes up to a 20% reduction in coupling for the most distant atoms.
The cavity cooperativity together with the detuning δ c determines the relative strength of coherent interactions and two dissipation pathways: spontaneous emission into free space and collective emission into the cavity. Collective emission can be suppressed at fixed interaction strength by increasing the detuning δ c from cavity resonance. This suppression is possible because the collective decay rate scales as \({{\boldsymbol{\Gamma }}}_{\pm }\propto {\delta }_{{\rm{c}}}^{-2}\) ﻿, whereas the interaction strength for each mode scales as \({\chi }_{k}\propto {\delta }_{{\rm{c}}}^{-1}\).
 However, decreasing collective decay comes at the cost of increasing the rate of free-space scattering Γ sc , which is independent of δ c.
 Both interaction and decay via the cavity are enhanced with respect to free-space scattering by the collective cooperativity \(N\eta \gg 1\) , which determines an optimal detuning for minimizing the combined rate of single-particle and collective decay. In our system, this optimal detuning is given by \(|{\delta }_{{\rm{opt}}}/\kappa |=\sqrt{\frac{N\eta }{192}}\) (as derived in the Supplementary Information).
At the optimal detuning, the overall interaction-to-decay ratio depends on the collective cooperativity as \(|{\chi }_{k}|/({{\boldsymbol{\Gamma }}}_{+}+{{\boldsymbol{\Gamma }}}_{-}+{{\boldsymbol{\Gamma }}}_{{\rm{s}}{\rm{c}}})\propto \sqrt{N\eta }\).
 As a result, large collective cooperativity \(N\eta \gg 1\) enables entangled states to be generated 53.
 In the Supplementary Information, we analyse the role of the cooperativity in producing spin-nematic squeezed states, showing that the attainable metrological gain due to entanglement scales as \(\sqrt{N\eta }\).
Our experiments operate at approximately twice the theoretical optimum detuning to reduce sensitivity to atom number fluctuations. These fluctuations change the frequency shift 4 N MΩ of the cavity resonance and thus the detuning δ c and interaction strength χ k.
 Within a single set of measurements, the total atom number varies by up to 3%, resulting in shot-to-shot fluctuations in the collective interaction strength of 20%. This is a small contribution to the variability of the pair creation process, which naturally produces fluctuations with standard deviations on the same order as the expected population in the states \(m=\pm 1\) (ref.
17 ).
Working at a detuning that is larger than the optimum means that dissipation is primarily due to scattering to free space. For typical parameters, the scattering rate is 0.2 scattering events per atom per Bloch period, corresponding to a coherence time of 5 Bloch periods. The effect of this scattering is primarily evident in measurements of covariance and the structure factor. For example, at the latest times in Fig.
2b, c approximately 50% of the atoms have scattered at least once. This causes much of the reduction in the magnitude of the structure factor as compared to the idealized simulations using the truncated Wigner approximation seen in Extended Data Fig.
4.
 For the correlations that are shown in other figures, the normalization scheme chosen minimizes the impact of atom number and interaction strength fluctuations on the extracted spatial structure.
Interaction Hamiltonian In equation ( 1 ), we describe the distance-dependent spin-exchange interactions by a static effective Hamiltonian H I , with the spin on each site defined in a rotating frame set by the local magnetic field. Here we summarize the derivation of the effective Hamiltonian starting from the full time-dependent Hamiltonian \({H}_{{\rm{lab}}}\) in the laboratory frame. The Hamiltonian \({H}_{{\rm{lab}}}\) for the spin system, obtained by adiabatically eliminating the cavity mode 17 , 18 , is given by $${H}_{{\rm{lab}}}=-\tilde{J}(t)\sum _{l,m}{F}_{l}^{+}{F}_{m}^{-}+\sum _{l}{h}_{l}{F}_{l}^{z}+{H}_{{\rm{q}}},$$ in terms of the collective spin \({{\bf{F}}}_{l}=\sum _{\mu \in l}{{\bf{f}}}_{\mu }\) on each site l , the local magnetic fields \({h}_{l}={\omega }_{B}l\) and the quadratic Zeeman shift \({H}_{{\rm{q}}}=q\sum _{\mu }{({f}_{\mu }^{z})}^{2}\) , in units where \(\hbar =1\).
 Moving to a rotating frame with \({H}_{0}=\sum _{l}{h}_{l}{F}_{l}^{z}\) , the Hamiltonian becomes $$H(t)=-\tilde{J}(t)\sum _{l,m}{{\rm{e}}}^{{\rm{i}}(l-m){\omega }_{B}t}{F}_{l}^{+}{F}_{m}^{-}+{H}_{{\rm{q}}}$$ To obtain a form of the effective Hamiltonian that provides intuition about the spatial structure of the interactions, we consider the limit in which the collective interaction strength and quadratic Zeeman shift are weak compared with the gradient \((NJ,q\ll {\omega }_{B})\).
 In this limit, the effective Hamiltonian is given to first order by the time average of equation ( 9 ). The interaction component of the resulting effective Hamiltonian H I + H q is $${H}_{{\rm{I}}}=-\sum _{l,m}J(l-m){F}_{l}^{+}{F}_{m}^{-},$$ where $$J(r)=\frac{1}{T}{\int }_{0}^{T}{\rm{d}}t\,{{\rm{e}}}^{{\rm{i}}r{\omega }_{B}t}\tilde{J}(t).$$ The dependence \(J(r)\) of the couplings on distance is thus given by the Fourier transform of the drive waveform.
Even though the limits under which this effective Hamiltonian is derived, \(NJ,q\ll {\omega }_{B}\) , are not strictly valid for the pulsed drive waveforms used to produce periodic boundary conditions, the intuition provided by this model is corroborated by the more generically valid model of the Floquet dynamics presented in the following section.
Momentum-space dynamics To analytically compute the dynamics of the system, we write the Hamiltonian without approximation in terms of spin-wave operators \({\tilde{F}}_{k={\omega }_{B}t}^{+}\equiv \frac{1}{\sqrt{M}}\sum _{l}{{\rm{e}}}^{-{\rm{i}}kl}{F}_{l}^{+}\) , as $$H(t)=-M\tilde{J}(t){\tilde{F}}_{-{\omega }_{B}t}^{+}{\tilde{F}}_{{\omega }_{B}t}^{-}+{H}_{{\rm{q}}}.$$ We can understand this Hamiltonian by recognizing that, in the laboratory frame, the magnetic field gradient causes spin waves to undergo Bloch oscillations at frequency \({\omega }_{B}\).
 Only spin waves with momentum k = 0 in the laboratory frame couple to the cavity. In the rotating frame set by the gradient, the same physics can be viewed as spin waves remaining static over time, and the mode to which the cavity couples is given by \(k=\omega t\).
 The quadratic Zeeman shift is left unchanged by the change of reference frames.
Because the system is finite and discrete, there are only M orthogonal momentum modes. To obtain a discrete set of momentum-space couplings \({\tilde{J}}_{k}=-{\chi }_{k}/2N\) , we drive interactions with a pulsed drive \(\tilde{J}(t)=\sum _{k}\frac{2{\rm{\pi }}}{M}{\tilde{J}}_{k}\delta ({\omega }_{B}t-k)\) that only takes on non-zero values M times per Bloch period. We observe that the momentum modes decouple in the Hamiltonian, $$H(t)=-\sum _{k}2{\rm{\pi }}{\tilde{J}}_{k}\delta (t{\omega }_{B}-k){\tilde{F}}_{-k}^{+}{\tilde{F}}_{k}^{-}+{H}_{{\rm{q}}}.$$ The evolution of any given momentum mode is discrete, with a short period of coupling to the optical cavity that induces spin–spin interactions, followed by a longer period of time when the state evolves only under the quadratic Zeeman shift. In the limit of a large collective interaction strength \(|{\chi }_{k}| > {\omega }_{B}\) , each momentum mode grows by a factor of \(\lambda \approx |2{\chi }_{k}{\tau }_{{\rm{B}}}|\sin (q{\tau }_{{\rm{B}}})\) after each Bloch period (Supplementary Information). This growth is reflected by the structure factor, with \(|{\tilde{F}}_{k}^{x}|\,\propto \,|{\chi }_{k}{|}^{T}\,\propto \,|\tilde{J}(k/{\omega }_{B}){|}^{T}\) after T Bloch periods.
Even though our derivation of the growth of the structure factor assumes a pulsed drive field, which produces periodic boundary conditions, the same relation provides a good approximation in the case of a continuous drive field that produces open boundary conditions. In the latter case, we expect small deviations from the model because the cavity couples to a continuum of non-orthogonal momentum modes. We compare the continuous and pulsed cases in a numerical simulation presented in Extended Data Fig.
4.
A key feature of the evolution in momentum space is that the modes with minimum energy are maximally amplified in our system with χ k < 0. We can gain additional insight into this effect by considering the limit in which the dynamics are slow compared with the Bloch period and a time-averaged Hamiltonian is valid. In this case, the dynamics for each momentum mode are identical to the single-mode case that has been studied previously 17 , 54.
 The system is unstable to pair creation when the collective interaction strength \(2{\chi }_{k}=-4N{\tilde{J}}_{k}\) has a greater magnitude and opposite sign from the quadratic Zeeman shift q.
 This condition motivates our choice of ferromagnetic on-site interactions, such that χ k < 0, in our system with q > 0. The opposite signs of χ and q allow the system to access low-energy states of the interaction Hamiltonian H I by transferring energy into H q via pair creation.
Numerical modelling We numerically simulate the dynamics in our system using the semiclassical truncated Wigner approximation (TWA) 55 , 56 , 57.
 To model quantum effects, which are essential for the pair-creation dynamics, the TWA simulation treats each ensemble of three-level atoms as three bosonic modes and samples the vacuum fluctuations of the initially unoccupied modes \(m=\pm 1\).
 This corresponds to sampling the Wigner function of the initial state in phase space. Each sample is then propagated according to the classical equations of motion based on the Hamiltonian in equation ( 9 ). This enables us to incorporate experimental imperfections such as finite statistics (Extended Data Fig.
3 ) or finite system size (Extended Data Fig.
4 ) into the simulation, and to understand their effects on the measured data.
In the Supplementary Information we elaborate on the implementation of the TWA simulation and present additional simulations for comparison with our experimental data. In particular, we show effects of finite statistics for the reconstruction of the triangular ladder in Fig.
3c , and we examine the role of magnetic field fluctuations in the measurement of bipartite correlations in Fig.
4e.
Euclidean reconstruction To reconstruct effective coordinates ρ and inferred couplings J ′ directly from measured correlations C xx , we require an ansatz for the dependence of correlations on distance in the effective geometry. Here we apply our analytical model for the growth of the structure factor to derive the Gaussian ansatz for the decay of correlations. The dynamical evolution produces low energy states of the XY Hamiltonian, which additionally allows us to relate the inverse correlation matrix and the inferred couplings.
To analytically motivate the Gaussian ansatz used for reconstructing effective geometries, we begin by relating the structure factor to the correlations we measure in the \(\hat{x}\) basis, $${C}_{lm}^{xx} \sim \langle {F}_{l}^{x}{F}_{m}^{x}\rangle =\frac{1}{M}\sum _{{k}_{1},{k}_{2}}{{\rm{e}}}^{{\rm{i}}({k}_{1}l-{k}_{2}m)}\langle {\tilde{F}}_{{k}_{1}}^{x}{\tilde{F}}_{-{k}_{2}}^{x}\rangle =\frac{1}{M}\sum _{k}{{\rm{e}}}^{{\rm{i}}k(l-m)}|{\tilde{F}}_{k}^{x}{|}^{2}.$$ The final equality holds when the momentum modes are independent from one another, such that cross terms with \({k}_{1}\ne {k}_{2}\) go to zero. This is true either when periodic boundary conditions are imposed or in the limit of an infinite system. Equation ( 14 ) enables the prediction of the form of spatial correlations from the dispersion relation \({\chi }_{k}\) , which governs the growth of the structure factor.
As an illustrative example, we consider nearest-neighbour interactions created by the drive waveform \(\tilde{J}(t)\propto (\cos \,{\omega }_{B}t+1)\) , corresponding to the dispersion relation $${\chi }_{k}\propto {({{\rm{e}}}^{{\rm{i}}k/2}+{{\rm{e}}}^{-{\rm{i}}k/2})}^{2}.$$ As the correlations are the Fourier transform of the squared magnitude of the structure factor, we write an expansion of \(|{\tilde{F}}_{k}^{x}{|}^{2}\) in terms of powers of e i k.
 Recalling \(|{\tilde{F}}_{k}^{x}|\propto |{\chi }_{k}{|}^{T}\) after T Bloch periods of evolution, we compute $$|{\mathop{F}\limits^{ \sim }}_{k}^{x}{|}^{2}\propto {({{\rm{e}}}^{{\rm{i}}k/2}+{{\rm{e}}}^{-{\rm{i}}k/2})}^{4T}=\mathop{\sum }\limits_{d=-2T}^{2T}(\genfrac{}{}{0ex}{}{4T}{d+2T}){{\rm{e}}}^{-{\rm{i}}kd}.$$ The coefficients in this expansion are Fourier components corresponding to correlations at distance d.
 Thus, we have \({C}^{xx}(d)\propto (\genfrac{}{}{0ex}{}{4T}{d+2T}).\) This binomial coefficient tends to a Gaussian function of distance d after several Bloch periods, analogously to a diffusion process.
More generally a multifrequency drive leads to diffusion within the effective geometry set by the couplings. For a generic drive that produces a dispersion relation \({\chi }_{k}\propto -\sum _{r}J(r){{\rm{e}}}^{{\rm{i}}kr}\) , correlations in position space are given by terms in the multinomial expansion of \(|{\chi }_{k}{|}^{2T}\).
 When J ( r ) > 0 this directly corresponds to a random walk within the effective geometry set by the couplings J ( r ). Motivated by the exact result for spreading in one dimension, we use a Gaussian ansatz for the correlation matrix to infer distances and hence the coordinates ρ within the effective geometry.
We motivate the inferred coupling matrix \(J{\prime} ={({C}^{xx})}^{-1}\) by recalling that a population growth rate given by | χ k | generates a low energy state of the XY model, H I.
 We approximate the final state as thermal, with large inverse temperature β.
 We make use of the SO(2) symmetry to note that \(\langle {F}_{i}^{x}{F}_{j}^{x}\rangle \) and \(\langle {F}_{i}^{y}{F}_{j}^{y}\rangle \) are equivalent. Now, to compute \(\langle {F}_{i}^{x}{F}_{j}^{x}\rangle \) , we integrate over phase space, with a Boltzmann weighting \(\exp (-\beta {H}_{{\rm{I}}}).\) To constrain the overall spin length, we introduce a chemical potential μ , so that $${C}_{ij}^{xx}\propto \prod _{l}[\int {\rm{d}}{F}_{l}^{x}]{F}_{i}^{x}{F}_{j}^{x}\exp (-\beta [{H}_{{\rm{I}}}-\mu {({F}_{l}^{x})}^{2}]).$$ The chemical potential can be incorporated into a modified coupling matrix \({J}_{ij}^{{\prime} }={J}_{ij}-\mu {\delta }_{ij}\).
 Evaluating the integral yields \({C}^{xx}\propto {J}_{ij}^{{\prime} -1}\).
 For the purposes of the reconstruction in Fig.
3 , where we colour bonds between sites according to \({J}_{ij}^{{\prime} }\) , only the off-diagonal terms of \({J}_{ij}^{{\prime} }\) are relevant.
The inverse correlation matrix, also known as the concentration or precision matrix, can also be interpreted as the partial correlation matrix 58 , up to normalization. For a given set of variables x i , the partial correlation between x i and x j is the correlation after regressing out every \({x}_{l\ne i,j}\).
 In a system with interactions at distance r , sites spaced by r have a non-zero partial correlation, but sites at distances that are multiples of r have zero partial correlation, because the interactions between the sites at distance r mediate all the variance. Thus, the interpretation of the inverse correlation matrix as an inferred coupling matrix \(J{\prime} \propto {({C}^{xx})}^{-1}\) is well motivated even at early times, when correlations are still spreading across the system.
Data availability All data displayed in Figs.
1 – 4 and Extended Data Figs.
1 – 4 are available from the corresponding author upon reasonable request.
Code availability All code used for simulation and analysis is available from the corresponding author upon reasonable request.
Change history 11 March 2022 A Correction to this paper has been published: https://doi.org/10.1038/s41586-022-04610-7 References Bloch, I., Dalibard, J. & Nascimbene, S. Quantum simulations with ultracold quantum gases.
Nat. Phys.
8 , 267–276 (2012).
Article CAS Google Scholar Browaeys, A. & Lahaye, T. Many-body physics with individually controlled Rydberg atoms.
Nat. Phys.
16 , 132–142 (2020).
Article CAS Google Scholar Hayden, P. & Preskill, J. Black holes as mirrors: quantum information in random subsystems.
J. High Energy Phys.
2007 , 120–120 (2007).
Article MathSciNet Google Scholar Maldacena, J. & Stanford, D. Remarks on the Sachdev-Ye-Kitaev model.
Phys. Rev. D 94 , 106002 (2016).
Article ADS MathSciNet Google Scholar Bentsen, G. et al. Treelike interactions and fast scrambling with cold atoms.
Phys. Rev. Lett.
123 , 130601 (2019).
Article ADS CAS PubMed Google Scholar Belyansky, R., Bienias, P., Kharkov, Y. A., Gorshkov, A. V. & Swingle, B. Minimal model for fast scrambling.
Phys. Rev. Lett.
125 , 130601 (2020).
Article ADS MathSciNet CAS PubMed PubMed Central Google Scholar Das, A. & Chakrabarti, B. K. Colloquium: quantum annealing and analog quantum computation.
Rev. Mod. Phys.
80 , 1061–1081 (2008).
Article ADS MathSciNet MATH Google Scholar Gopalakrishnan, S., Lev, B. L. & Goldbart, P. M. Frustration and glassiness in spin models with cavity-mediated interactions.
Phys. Rev. Lett.
107 , 277201 (2011).
Article ADS PubMed Google Scholar Strack, P. & Sachdev, S. Dicke quantum spin glass of atoms and photons.
Phys. Rev. Lett.
107 , 277202 (2011).
Article PubMed Google Scholar McMahon, P. L. et al. A fully programmable 100-spin coherent Ising machine with all-to-all connections.
Science 354 , 614–617 (2016).
Article ADS MathSciNet CAS PubMed Google Scholar Berloff, N. G. et al. Realizing the classical XY Hamiltonian in polariton simulators.
Nat. Mater.
16 , 1120–1126 (2017).
Article ADS CAS PubMed Google Scholar Leroux, I. D., Schleier-Smith, M. H. & Vuletić, V. Implementation of cavity squeezing of a collective atomic spin.
Phys. Rev. Lett.
104 , 073602 (2010).
Article ADS PubMed Google Scholar Barontini, G., Hohmann, L., Haas, F., Estève, J. & Reichel, J. Deterministic generation of multiparticle entanglement by quantum Zeno dynamics.
Science 349 , 1317–1321 (2015).
Article ADS MathSciNet CAS MATH PubMed Google Scholar Hosten, O., Krishnakumar, R., Engelsen, N. J. & Kasevich, M. A. Quantum phase magnification.
Science 352 , 1552–1555 (2016).
Article ADS MathSciNet CAS MATH PubMed Google Scholar Pedrozo-Peñafiel, E. et al. Entanglement on an optical atomic-clock transition.
Nature 588 , 414–418 (2020).
Article ADS PubMed Google Scholar Welte, S., Hacker, B., Daiss, S., Ritter, S. & Rempe, G. Photon-mediated quantum gate between two neutral atoms in an optical cavity.
Phys. Rev. X 8 , 011018 (2018).
CAS Google Scholar Davis, E. J., Bentsen, G., Homeier, L., Li, T. & Schleier-Smith, M. H. Photon-mediated spin-exchange dynamics of spin-1 atoms.
Phys. Rev. Lett.
122 , 010405 (2019).
Article ADS CAS PubMed Google Scholar Davis, E. J. et al. Protecting spin coherence in a tunable Heisenberg model.
Phys. Rev. Lett.
125 , 060402 (2020).
Article ADS CAS PubMed Google Scholar Muniz, J. A. et al. Exploring dynamical phase transitions with cold atoms in an optical cavity.
Nature 580 , 602–607 (2020).
Article ADS CAS PubMed Google Scholar Barbón, J. L. & Magán, J. M. Fast scramblers and ultrametric black hole horizons.
J. High Energy Phys.
2013 , 163 (2013).
Article ADS MathSciNet MATH Google Scholar Gubser, S. S., Knaute, J., Parikh, S., Samberg, A. & Witaszczyk, P.
p -adic AdS/CFT.
Commun. Math. Phys.
352 , 1019–1059 (2017).
Article ADS MathSciNet MATH Google Scholar Heydeman, M., Marcolli, M., Saberi, I. & Stoica, B. Tensor networks, p-adic fields, and algebraic curves: arithmetic and the AdS3/CFT2 correspondence. Preprint at https://arxiv.org/abs/1605.07639 (2016).
Qi, X.-L. Does gravity come from quantum information? Nat. Phys.
14 , 984–987 (2018).
Article CAS Google Scholar Hung, C.-L., González-Tudela, A., Cirac, J. I. & Kimble, H. J. Quantum spin dynamics with pairwise-tunable, long-range interactions.
Proc. Natl Acad. Sci. USA 113 , E4946–E4955 (2016).
Article MathSciNet CAS PubMed PubMed Central MATH Google Scholar Marsh, B. P. et al. Enhancing associative memory recall and storage capacity using confocal cavity QED.
Phys. Rev. X 11 , 021048 (2021).
CAS Google Scholar Anikeeva, G. et al. Number partitioning with Grover’s algorithm in central spin systems.
PRX Quantum 2 , 020319 (2021).
Article ADS Google Scholar Masson, S. J., Barrett, M. & Parkins, S. Cavity QED engineering of spin dynamics and squeezing in a spinor gas.
Phys. Rev. Lett.
119 , 213601 (2017).
Article ADS PubMed Google Scholar Qin, Z. et al. Characterizing the multipartite continuous-variable entanglement structure from squeezing coefficients and the Fisher information.
npj Quantum Inf.
5 , 3 (2019).
Article ADS Google Scholar Pezzè, L., Smerzi, A., Oberthaler, M. K., Schmied, R. & Treutlein, P. Quantum metrology with nonclassical states of atomic ensembles.
Rev. Mod. Phys.
90 , 035005 (2018).
Article ADS MathSciNet Google Scholar Omran, A. et al. Generation and manipulation of Schrödinger cat states in Rydberg atom arrays.
Science 365 , 570–574 (2019).
Article ADS MathSciNet CAS PubMed Google Scholar Hamley, C. D., Gerving, C., Hoang, T., Bookjans, E. & Chapman, M. S. Spin-nematic squeezed vacuum in a quantum gas.
Nat. Phys.
8 , 305–308 (2012).
Article CAS Google Scholar Fadel, M., Zibold, T., Décamps, B. & Treutlein, P. Spatial entanglement patterns and Einstein-Podolsky-Rosen steering in Bose-Einstein condensates.
Science 360 , 409–413 (2018).
Article ADS MathSciNet CAS MATH PubMed Google Scholar Kunkel, P. et al. Spatially distributed multipartite entanglement enables EPR steering of atomic clouds.
Science 360 , 413–416 (2018).
Article ADS MathSciNet CAS MATH PubMed Google Scholar Lange, K. et al. Entanglement between two spatially separated atomic modes.
Science 360 , 416–418 (2018).
Article ADS MathSciNet CAS MATH PubMed Google Scholar Islam, R. et al. Emergence and frustration of magnetism with variable-range interactions in a quantum simulator.
Science 340 , 583–587 (2013).
Article ADS CAS PubMed Google Scholar Jurcevic, P. et al. Quasiparticle engineering and entanglement propagation in a quantum many-body system.
Nature 511 , 202–205 (2014).
Article ADS CAS PubMed Google Scholar Vaidya, V. D. et al. Tunable-range, photon-mediated atomic interactions in multimode cavity QED.
Phys. Rev. X 8 , 011002 (2018).
CAS Google Scholar Manovitz, T., Shapira, Y., Akerman, N., Stern, A. & Ozeri, R. Quantum simulations with complex geometries and synthetic gauge fields in a trapped ion chain.
PRX Quantum 1 , 020303 (2020).
Article Google Scholar Kollár, A. J., Fitzpatrick, M. & Houck, A. A. Hyperbolic lattices in circuit quantum electrodynamics.
Nature 571 , 45–50 (2019).
Article ADS PubMed Google Scholar Lücke, B. et al. Detecting multiparticle entanglement of Dicke states.
Phys. Rev. Lett.
112 , 155304 (2014).
Article ADS PubMed Google Scholar Lee, S. & Lee, K.-C. Phase transitions in the fully frustrated triangular XY model.
Phys. Rev. B 57 , 8472 (1998).
Article ADS CAS Google Scholar Gubser, S. S., Jepsen, C., Ji, Z. & Trundy, B. Continuum limits of sparse coupling patterns.
Phys. Rev. D 98 , 045009 (2018).
Article ADS MathSciNet CAS Google Scholar Shi, Y.-Y., Duan, L.-M. & Vidal, G. Classical simulation of quantum many-body systems with a tree tensor network.
Phys. Rev. A 74 , 022320 (2006).
Article ADS Google Scholar Murg, V., Verstraete, F., Legeza, Ö. & Noack, R. M. Simulating strongly correlated quantum systems with tree tensor networks.
Phys. Rev. B 82 , 205105 (2010).
Article ADS Google Scholar Pastawski, F., Yoshida, B., Harlow, D. & Preskill, J. Holographic quantum error-correcting codes: toy models for the bulk/boundary correspondence.
J. High Energ. Phys.
2015 , 149 (2015).
Article MathSciNet MATH Google Scholar Amit, D. J., Gutfreund, H. & Sompolinsky, H. Spin-glass models of neural networks.
Phys. Rev. A 32 , 1007–1018 (1985).
Article ADS MathSciNet CAS Google Scholar Aidelsburger, M. et al. Measuring the Chern number of Hofstadter bands with ultracold bosonic atoms.
Nat. Phys.
11 , 162–166 (2015).
Article CAS Google Scholar Kennedy, C. J., Burton, W. C., Chung, W. C. & Ketterle, W. Observation of Bose–Einstein condensation in a strong synthetic magnetic field.
Nat. Phys.
11 , 859–864 (2015).
Article CAS Google Scholar Zeiher, J. et al. Microscopic characterization of scalable coherent Rydberg superatoms.
Phys. Rev. X 5 , 031015 (2015).
Google Scholar Evans, R. E. et al. Photon-mediated interactions between quantum emitters in a diamond nanocavity.
Science 362 , 662–665 (2018).
Article ADS CAS PubMed Google Scholar Lee, J., Vrijsen, G., Teper, I., Hosten, O. & Kasevich, M. A. Many-atom–cavity QED system with homogeneous atom–cavity coupling.
Opt. Lett.
39 , 4005–4008 (2014).
Article ADS PubMed Google Scholar Xu, V. et al. Probing gravity by holding atoms for 20 seconds.
Science 366 , 745–749 (2019).
Article ADS CAS PubMed Google Scholar Sørensen, A. S. & Mølmer, K. Entangling atoms in bad cavities.
Phys. Rev. A 66 , 022314 (2002).
Article ADS MathSciNet Google Scholar Stamper-Kurn, D. M. & Ueda, M. Spinor Bose gases: symmetries, magnetism, and quantum dynamics.
Rev. Mod. Phys.
85 , 1191 (2013).
Article ADS CAS Google Scholar Sinatra, A., Lobo, C. & Castin, Y. The truncated Wigner method for Bose-condensed gases: limits of validity and applications.
J. Phys. B 35 , 3599–3631 (2002).
Article ADS CAS Google Scholar Blakie, P. B., Bradley, A. S., Davis, M. J., Ballagh, R. J. & Gardiner, C. W. Dynamics and statistical mechanics of ultra-cold Bose gases using c-field techniques.
Adv. Phys.
57 , 363–455 (2008).
Article ADS CAS Google Scholar Lewis-Swan, R. J., Olsen, M. K. & Kheruntsyan, K. V. Approximate particle number distribution from direct stochastic sampling of the Wigner function.
Phys. Rev. A 94 , 033814 (2016).
Article ADS Google Scholar Lauritzen, S. L.
Graphical Models Vol. 17 (Clarendon Press, 1996).
Download references Acknowledgements We thank S. Gubser for discussions that inspired our exploration of non-Archimedean geometry. We also acknowledge discussions with G. Bentsen, A. Daley, I. Bloch, B. Lev, N. Berloff, A. Deshpande, B. Swingle and P. Hayden. This work was supported by the DOE Office of Science, Office of High Energy Physics and Office of Basic Energy Sciences under grant no. DE-SC0019174. A.P. and E.S.C. acknowledge support from the NSF under grant no. PHY-1753021. We additionally acknowledge support from the National Defense Science and Engineering Graduate Fellowship (A.P.), the NSF Graduate Research Fellowship Program (E.J.D. and E.S.C.), the Hertz Foundation (E.J.D.) and the German Academic Scholarship Foundation (J.F.W.).
Author information Author notes These authors contributed equally: Avikar Periwal, Eric S. Cooper, Philipp Kunkel Authors and Affiliations Department of Physics, Stanford University, Stanford, CA, USA Avikar Periwal, Eric S. Cooper, Philipp Kunkel, Julian F. Wienand, Emily J. Davis & Monika Schleier-Smith SLAC National Accelerator Laboratory, Menlo Park, CA, USA Philipp Kunkel & Monika Schleier-Smith Fakultät für Physik, Ludwig-Maximilians-Universität, Munich, Germany Julian F. Wienand Authors Avikar Periwal View author publications You can also search for this author in PubMed Google Scholar Eric S. Cooper View author publications You can also search for this author in PubMed Google Scholar Philipp Kunkel View author publications You can also search for this author in PubMed Google Scholar Julian F. Wienand View author publications You can also search for this author in PubMed Google Scholar Emily J. Davis View author publications You can also search for this author in PubMed Google Scholar Monika Schleier-Smith View author publications You can also search for this author in PubMed Google Scholar Contributions A.P., E.S.C., P.K., J.F.W. and E.J.D. performed the experiments. A.P., E.S.C., P.K. and M.S.-S. analysed the experimental data and developed supporting theoretical models. A.P., E.S.C., P.K. and M.S.-S. wrote the manuscript. All authors contributed to the discussion and interpretation of results.
Corresponding author Correspondence to Monika Schleier-Smith.
Ethics declarations Competing interests The authors declare no competing interests.
Additional information Peer review information Nature thanks Robert Lewis-Swan and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.
Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
Extended data figures and tables Extended Data Fig. 1 Coupling graphs.
Sketch of couplings \(J(i-j)\) for the model in equation ( 4 ) with local interactions ( s = − 1, left) or treelike interactions ( s = 1, right). The strengths of the interactions are indicated by the thickness and transparency of the red lines. For s = 1, reordering the sites according to the Monna map makes the couplings more local, corroborating the treelike geometry.
Extended Data Fig. 2 Experimental sequence and imaging.
a Schematic of experimental sequence for measurements of \({F}_{i}^{x}\).
 After driving the cavity to induce interactions, we apply spin rotations sequentially to the M sites of the array and subsequently perform state-sensitive readout via fluorescence imaging.
b Fluorescence images after spin rotation, showing the signal for the F = 2 manifold and the three magnetic substates for the case of interactions at distance r = 3 with periodic boundary conditions.
c Transverse magnetization \({F}_{i}^{x}\) and structure factor \({\tilde{F}}_{k}^{x}\) extracted from the image in b.
Extended Data Fig. 3 Effect of finite statistics.
Left, correlation plot reproduced from Fig.
1 , showing \({C}^{{\rm{pm}}}\) obtained from 50 realizations of the experiment with interactions at distance r = 10. Right, simulation results obtained from a truncated Wigner approximation, where we either choose the same number of realisations as in the experiment or increase the number of realisations by a factor of 10 to reduce statistical uncertainty. The simulations indicate that residual correlations in the experimental data are mainly due to the finite sample size.
Extended Data Fig. 4 Comparison between measured structure factor and simulation results.
The left graph shows the measured structure factor after T = 3 Bloch periods of evolution, which is also shown in Fig.
2c.
 The two plots at right show results of a truncated Wigner simulation with and without periodic boundary conditions. For the simulated data we used 100 realizations of the TWA simulation, which is four times higher than the number of experimental realizations to reduce statistical fluctuations. For open boundary conditions, we find that the simulation has an offset with respect to the theoretical prediction (blue line). We attribute this offset to the finite system size, as the model is exact only for an infinite system or a system with periodic boundary conditions. Repeating the same simulation with a pulsed drive shown on the right shows that in this case the TWA simulation is consistent with the analytical model. The error bars indicate the standard error of the mean.
Full size table Supplementary information Supplementary Figs. 1–4 and references.
Rights and permissions Reprints and Permissions About this article Cite this article Periwal, A., Cooper, E.S., Kunkel, P.
et al.
Programmable interactions and emergent geometry in an array of atom clouds.
Nature 600 , 630–635 (2021). https://doi.org/10.1038/s41586-021-04156-0 Download citation Received : 07 June 2021 Accepted : 15 October 2021 Published : 22 December 2021 Issue Date : 23 December 2021 DOI : https://doi.org/10.1038/s41586-021-04156-0 Share this article Anyone you share the following link with will be able to read this content: Sorry, a shareable link is not currently available for this article.
Provided by the Springer Nature SharedIt content-sharing initiative This article is cited by Many-body cavity quantum electrodynamics with driven inhomogeneous emitters Mi Lei Rikuto Fukumori Andrei Faraon Nature (2023) Engineering random spin models with atoms in a high-finesse cavity Nick Sauerwein Francesca Orsi Jean-Philippe Brantut Nature Physics (2023) High-fidelity parallel entangling gates on a neutral-atom quantum computer Simon J. Evered Dolev Bluvstein Mikhail D. Lukin Nature (2023) Spectral engineering of cavity-protected polaritons in an atomic ensemble Mohamed Baghdad Pierre-Antoine Bourdel Romain Long Nature Physics (2023) Programmable large-scale simulation of bosonic transport in optical synthetic frequency lattices Alen Senanian Logan G. Wright Peter L. McMahon Nature Physics (2023) Comments By submitting a comment you agree to abide by our Terms and Community Guidelines.
 If you find something abusive or that does not comply with our terms or guidelines please flag it as inappropriate.
You have full access to this article via your institution.
Download PDF Download PDF Advertisement Explore content Research articles News Opinion Research Analysis Careers Books & Culture Podcasts Videos Current issue Browse issues Collections Subjects Follow us on Facebook Follow us on Twitter Sign up for alerts RSS feed About the journal Journal Staff About the Editors Journal Information Our publishing models Editorial Values Statement Journal Metrics Awards Contact Editorial policies History of Nature Send a news tip Publish with us For Authors For Referees Language editing services Submit manuscript Search Quick links Explore articles by subject Find a job Guide to authors Editorial policies Nature ( Nature ) ISSN 1476-4687 (online) ISSN 0028-0836 (print) nature.com sitemap About Nature Portfolio About us Press releases Press office Contact us Discover content Journals A-Z Articles by subject Nano Protocol Exchange Nature Index Publishing policies Nature portfolio policies Open access Author & Researcher services Reprints & permissions Research data Language editing Scientific editing Nature Masterclasses Live Expert Trainer-led workshops Research Solutions Libraries & institutions Librarian service & tools Librarian portal Open research Recommend to library Advertising & partnerships Advertising Partnerships & Services Media kits Branded content Career development Nature Careers Nature Conferences Nature events Regional websites Nature Africa Nature China Nature India Nature Italy Nature Japan Nature Korea Nature Middle East Privacy Policy Use of cookies Your privacy choices/Manage cookies Legal notice Accessibility statement Terms & Conditions Your US state privacy rights © 2023 Springer Nature Limited Close Sign up for the Nature Briefing newsletter — what matters in science, free to your inbox daily.
Close Get the most important science stories of the day, free in your inbox.
